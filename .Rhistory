)
fig <-
fig |>
layout(
font = list(
size = 12,
color = "#000000",
weight = "bold"
),
paper_bgcolor = "#D3D3D3",
plot_bgcolor = "#D3D3D3"
)
fig
#| label: grafico-sankey-uso
#| warning: false
#| message: false
#| code-fold: true
#| code-summary: "Código para la generación del gráfico de Sankey"
puntos_sankey <-
puntos |>
select(sample_id, t1_uso, t2_uso)
# write_csv(puntos_sankey, "puntos_sankey.csv")
# puntos_sankey <- read_csv("puntos_sankey.csv")
# El prefijo es para diferenciar t1 y t2 en el gráfico de Sankey
puntos_sankey <-
puntos_sankey |>
mutate(
t1_uso = paste0("T1-", t1_uso),
t2_uso = paste0("T2-", t2_uso)
)
label <- c("T1-1000-MC bosques", "T1-2000-Agricultura", "T1-3000-Ganad y past",
"T1-4000-Zonas humed", "T1-5000-Infraest", "T1-6000-Otras tierras",
"T1-7000 No clasif", "T1-Nulo",
"T2-1000-MC bosques", "T2-2000-Agricultura", "T2-3000-Ganad y past",
"T2-4000-Zonas humed", "T2-5000-Infraest", "T2-6000-Otras tierras",
"T2-7000 No clasif", "T2-Nulo"
)
color <- c(COLOR_MC_BOSQUES, COLOR_AGRICULTURA, COLOR_GANADERIA_Y_PASTOS,
COLOR_ZONAS_HUMEDALES, COLOR_INFRAESTRUCTURA, COLOR_OTRAS_TIERRAS,
COLOR_NO_CLASIFICACION, COLOR_NULO,
COLOR_MC_BOSQUES, COLOR_AGRICULTURA, COLOR_GANADERIA_Y_PASTOS,
COLOR_ZONAS_HUMEDALES, COLOR_INFRAESTRUCTURA, COLOR_OTRAS_TIERRAS,
COLOR_NO_CLASIFICACION, COLOR_NULO
)
# Agregar columnas de códigos para usar en el gráfico de Sankey
puntos_sankey <- puntos_sankey |>
mutate(
t1_codigo = case_when(
t1_uso == 'T1-1000-MC bosques' ~ 0,
t1_uso == 'T1-2000-Agricultura' ~ 1,
t1_uso == 'T1-3000-Ganad y past' ~ 2,
t1_uso == 'T1-4000-Zonas humed' ~ 3,
t1_uso == 'T1-5000-Infraest' ~ 4,
t1_uso == 'T1-6000-Otras tierras' ~ 5,
t1_uso == 'T1-7000 No clasif' ~ 6,
t1_uso == 'T1-Nulo' ~ 7
),
t2_codigo = case_when(
t2_uso == 'T2-1000-MC bosques' ~ 8,
t2_uso == 'T2-2000-Agricultura' ~ 9,
t2_uso == 'T2-3000-Ganad y past' ~ 10,
t2_uso == 'T2-4000-Zonas humed' ~ 11,
t2_uso == 'T2-5000-Infraest' ~ 12,
t2_uso == 'T2-6000-Otras tierras' ~ 13,
t2_uso == 'T2-7000 No clasif' ~ 14,
t2_uso == 'T2-Nulo' ~ 15
)
)
# Contar las combinaciones de t1_codigo y t2_codigo
conteo_combinaciones <-
puntos_sankey |>
count(t1_codigo, t2_codigo)
# Crear las listas separadas
source <- conteo_combinaciones$t1_codigo
target <- conteo_combinaciones$t2_codigo
value <- conteo_combinaciones$n
# Gráfico de Sankey
grafico_sankey <-
plot_ly(
type = "sankey",
orientation = "h",
node = list(
label = label,
color = color,
pad = 15,
thickness = 20,
line = list(
color = "black",
width = 0.5
),
font = list(
size = 12,
color = "#000000",
weight = "bold"
)
),
link = list(
source = source,
target = target,
value =  value
)
)
grafico_sankey <-
grafico_sankey |>
layout(
font = list(
size = 12,
color = "#000000",
weight = "bold"
),
plot_bgcolor = "red",
)
#| label: grafico-sankey-uso
#| warning: false
#| message: false
#| code-fold: true
#| code-summary: "Código para la generación del gráfico de Sankey"
puntos_sankey <-
puntos |>
select(sample_id, t1_uso, t2_uso)
# write_csv(puntos_sankey, "puntos_sankey.csv")
# puntos_sankey <- read_csv("puntos_sankey.csv")
# El prefijo es para diferenciar t1 y t2 en el gráfico de Sankey
puntos_sankey <-
puntos_sankey |>
mutate(
t1_uso = paste0("T1-", t1_uso),
t2_uso = paste0("T2-", t2_uso)
)
label <- c("T1-1000-MC bosques", "T1-2000-Agricultura", "T1-3000-Ganad y past",
"T1-4000-Zonas humed", "T1-5000-Infraest", "T1-6000-Otras tierras",
"T1-7000 No clasif", "T1-Nulo",
"T2-1000-MC bosques", "T2-2000-Agricultura", "T2-3000-Ganad y past",
"T2-4000-Zonas humed", "T2-5000-Infraest", "T2-6000-Otras tierras",
"T2-7000 No clasif", "T2-Nulo"
)
color <- c(COLOR_MC_BOSQUES, COLOR_AGRICULTURA, COLOR_GANADERIA_Y_PASTOS,
COLOR_ZONAS_HUMEDALES, COLOR_INFRAESTRUCTURA, COLOR_OTRAS_TIERRAS,
COLOR_NO_CLASIFICACION, COLOR_NULO,
COLOR_MC_BOSQUES, COLOR_AGRICULTURA, COLOR_GANADERIA_Y_PASTOS,
COLOR_ZONAS_HUMEDALES, COLOR_INFRAESTRUCTURA, COLOR_OTRAS_TIERRAS,
COLOR_NO_CLASIFICACION, COLOR_NULO
)
# Agregar columnas de códigos para usar en el gráfico de Sankey
puntos_sankey <- puntos_sankey |>
mutate(
t1_codigo = case_when(
t1_uso == 'T1-1000-MC bosques' ~ 0,
t1_uso == 'T1-2000-Agricultura' ~ 1,
t1_uso == 'T1-3000-Ganad y past' ~ 2,
t1_uso == 'T1-4000-Zonas humed' ~ 3,
t1_uso == 'T1-5000-Infraest' ~ 4,
t1_uso == 'T1-6000-Otras tierras' ~ 5,
t1_uso == 'T1-7000 No clasif' ~ 6,
t1_uso == 'T1-Nulo' ~ 7
),
t2_codigo = case_when(
t2_uso == 'T2-1000-MC bosques' ~ 8,
t2_uso == 'T2-2000-Agricultura' ~ 9,
t2_uso == 'T2-3000-Ganad y past' ~ 10,
t2_uso == 'T2-4000-Zonas humed' ~ 11,
t2_uso == 'T2-5000-Infraest' ~ 12,
t2_uso == 'T2-6000-Otras tierras' ~ 13,
t2_uso == 'T2-7000 No clasif' ~ 14,
t2_uso == 'T2-Nulo' ~ 15
)
)
# Contar las combinaciones de t1_codigo y t2_codigo
conteo_combinaciones <-
puntos_sankey |>
count(t1_codigo, t2_codigo)
# Crear las listas separadas
source <- conteo_combinaciones$t1_codigo
target <- conteo_combinaciones$t2_codigo
value <- conteo_combinaciones$n
# Gráfico de Sankey
grafico_sankey <-
plot_ly(
type = "sankey",
orientation = "h",
node = list(
label = label,
color = color,
pad = 15,
thickness = 20,
line = list(
color = "black",
width = 0.5
),
font = list(
size = 12,
color = "#000000",
weight = "bold"
)
),
link = list(
source = source,
target = target,
value =  value
)
)
grafico_sankey <-
grafico_sankey |>
layout(
font = list(
size = 12,
color = "#000000",
weight = "bold"
),
plot_bgcolor = "red"
)
grafico_sankey
#| label: grafico-sankey-uso
#| warning: false
#| message: false
#| code-fold: true
#| code-summary: "Código para la generación del gráfico de Sankey"
puntos_sankey <-
puntos |>
select(sample_id, t1_uso, t2_uso)
# write_csv(puntos_sankey, "puntos_sankey.csv")
# puntos_sankey <- read_csv("puntos_sankey.csv")
# El prefijo es para diferenciar t1 y t2 en el gráfico de Sankey
puntos_sankey <-
puntos_sankey |>
mutate(
t1_uso = paste0("T1-", t1_uso),
t2_uso = paste0("T2-", t2_uso)
)
label <- c("T1-1000-MC bosques", "T1-2000-Agricultura", "T1-3000-Ganad y past",
"T1-4000-Zonas humed", "T1-5000-Infraest", "T1-6000-Otras tierras",
"T1-7000 No clasif", "T1-Nulo",
"T2-1000-MC bosques", "T2-2000-Agricultura", "T2-3000-Ganad y past",
"T2-4000-Zonas humed", "T2-5000-Infraest", "T2-6000-Otras tierras",
"T2-7000 No clasif", "T2-Nulo"
)
color <- c(COLOR_MC_BOSQUES, COLOR_AGRICULTURA, COLOR_GANADERIA_Y_PASTOS,
COLOR_ZONAS_HUMEDALES, COLOR_INFRAESTRUCTURA, COLOR_OTRAS_TIERRAS,
COLOR_NO_CLASIFICACION, COLOR_NULO,
COLOR_MC_BOSQUES, COLOR_AGRICULTURA, COLOR_GANADERIA_Y_PASTOS,
COLOR_ZONAS_HUMEDALES, COLOR_INFRAESTRUCTURA, COLOR_OTRAS_TIERRAS,
COLOR_NO_CLASIFICACION, COLOR_NULO
)
# Agregar columnas de códigos para usar en el gráfico de Sankey
puntos_sankey <- puntos_sankey |>
mutate(
t1_codigo = case_when(
t1_uso == 'T1-1000-MC bosques' ~ 0,
t1_uso == 'T1-2000-Agricultura' ~ 1,
t1_uso == 'T1-3000-Ganad y past' ~ 2,
t1_uso == 'T1-4000-Zonas humed' ~ 3,
t1_uso == 'T1-5000-Infraest' ~ 4,
t1_uso == 'T1-6000-Otras tierras' ~ 5,
t1_uso == 'T1-7000 No clasif' ~ 6,
t1_uso == 'T1-Nulo' ~ 7
),
t2_codigo = case_when(
t2_uso == 'T2-1000-MC bosques' ~ 8,
t2_uso == 'T2-2000-Agricultura' ~ 9,
t2_uso == 'T2-3000-Ganad y past' ~ 10,
t2_uso == 'T2-4000-Zonas humed' ~ 11,
t2_uso == 'T2-5000-Infraest' ~ 12,
t2_uso == 'T2-6000-Otras tierras' ~ 13,
t2_uso == 'T2-7000 No clasif' ~ 14,
t2_uso == 'T2-Nulo' ~ 15
)
)
# Contar las combinaciones de t1_codigo y t2_codigo
conteo_combinaciones <-
puntos_sankey |>
count(t1_codigo, t2_codigo)
# Crear las listas separadas
source <- conteo_combinaciones$t1_codigo
target <- conteo_combinaciones$t2_codigo
value <- conteo_combinaciones$n
# Gráfico de Sankey
grafico_sankey <-
plot_ly(
type = "sankey",
orientation = "h",
node = list(
label = label,
color = color,
pad = 15,
thickness = 20,
line = list(
color = "black",
width = 0.5
),
font = list(
size = 12,
color = "#000000",
weight = "bold"
)
),
link = list(
source = source,
target = target,
value =  value
)
)
grafico_sankey <-
grafico_sankey |>
layout(
font = list(
size = 12,
color = "#000000",
weight = "bold"
),
paper_bgcolor = "red"
)
grafico_sankey
#| label: grafico-sankey-uso
#| warning: false
#| message: false
#| code-fold: true
#| code-summary: "Código para la generación del gráfico de Sankey"
puntos_sankey <-
puntos |>
select(sample_id, t1_uso, t2_uso)
# write_csv(puntos_sankey, "puntos_sankey.csv")
# puntos_sankey <- read_csv("puntos_sankey.csv")
# El prefijo es para diferenciar t1 y t2 en el gráfico de Sankey
puntos_sankey <-
puntos_sankey |>
mutate(
t1_uso = paste0("T1-", t1_uso),
t2_uso = paste0("T2-", t2_uso)
)
label <- c("T1-1000-MC bosques", "T1-2000-Agricultura", "T1-3000-Ganad y past",
"T1-4000-Zonas humed", "T1-5000-Infraest", "T1-6000-Otras tierras",
"T1-7000 No clasif", "T1-Nulo",
"T2-1000-MC bosques", "T2-2000-Agricultura", "T2-3000-Ganad y past",
"T2-4000-Zonas humed", "T2-5000-Infraest", "T2-6000-Otras tierras",
"T2-7000 No clasif", "T2-Nulo"
)
color <- c(COLOR_MC_BOSQUES, COLOR_AGRICULTURA, COLOR_GANADERIA_Y_PASTOS,
COLOR_ZONAS_HUMEDALES, COLOR_INFRAESTRUCTURA, COLOR_OTRAS_TIERRAS,
COLOR_NO_CLASIFICACION, COLOR_NULO,
COLOR_MC_BOSQUES, COLOR_AGRICULTURA, COLOR_GANADERIA_Y_PASTOS,
COLOR_ZONAS_HUMEDALES, COLOR_INFRAESTRUCTURA, COLOR_OTRAS_TIERRAS,
COLOR_NO_CLASIFICACION, COLOR_NULO
)
# Agregar columnas de códigos para usar en el gráfico de Sankey
puntos_sankey <- puntos_sankey |>
mutate(
t1_codigo = case_when(
t1_uso == 'T1-1000-MC bosques' ~ 0,
t1_uso == 'T1-2000-Agricultura' ~ 1,
t1_uso == 'T1-3000-Ganad y past' ~ 2,
t1_uso == 'T1-4000-Zonas humed' ~ 3,
t1_uso == 'T1-5000-Infraest' ~ 4,
t1_uso == 'T1-6000-Otras tierras' ~ 5,
t1_uso == 'T1-7000 No clasif' ~ 6,
t1_uso == 'T1-Nulo' ~ 7
),
t2_codigo = case_when(
t2_uso == 'T2-1000-MC bosques' ~ 8,
t2_uso == 'T2-2000-Agricultura' ~ 9,
t2_uso == 'T2-3000-Ganad y past' ~ 10,
t2_uso == 'T2-4000-Zonas humed' ~ 11,
t2_uso == 'T2-5000-Infraest' ~ 12,
t2_uso == 'T2-6000-Otras tierras' ~ 13,
t2_uso == 'T2-7000 No clasif' ~ 14,
t2_uso == 'T2-Nulo' ~ 15
)
)
# Contar las combinaciones de t1_codigo y t2_codigo
conteo_combinaciones <-
puntos_sankey |>
count(t1_codigo, t2_codigo)
# Crear las listas separadas
source <- conteo_combinaciones$t1_codigo
target <- conteo_combinaciones$t2_codigo
value <- conteo_combinaciones$n
# Gráfico de Sankey
grafico_sankey <-
plot_ly(
type = "sankey",
orientation = "h",
node = list(
label = label,
color = color,
pad = 15,
thickness = 20,
line = list(
color = "black",
width = 0.5
),
font = list(
size = 12,
color = "#000000",
weight = "bold"
)
),
link = list(
source = source,
target = target,
value =  value,
color = "red"
)
)
grafico_sankey <-
grafico_sankey |>
layout(
font = list(
size = 12,
color = "#000000",
weight = "bold"
)
)
grafico_sankey
#| label: grafico-sankey-uso
#| warning: false
#| message: false
#| code-fold: true
#| code-summary: "Código para la generación del gráfico de Sankey"
puntos_sankey <-
puntos |>
select(sample_id, t1_uso, t2_uso)
# write_csv(puntos_sankey, "puntos_sankey.csv")
# puntos_sankey <- read_csv("puntos_sankey.csv")
# El prefijo es para diferenciar t1 y t2 en el gráfico de Sankey
puntos_sankey <-
puntos_sankey |>
mutate(
t1_uso = paste0("T1-", t1_uso),
t2_uso = paste0("T2-", t2_uso)
)
label <- c("T1-1000-MC bosques", "T1-2000-Agricultura", "T1-3000-Ganad y past",
"T1-4000-Zonas humed", "T1-5000-Infraest", "T1-6000-Otras tierras",
"T1-7000 No clasif", "T1-Nulo",
"T2-1000-MC bosques", "T2-2000-Agricultura", "T2-3000-Ganad y past",
"T2-4000-Zonas humed", "T2-5000-Infraest", "T2-6000-Otras tierras",
"T2-7000 No clasif", "T2-Nulo"
)
color <- c(COLOR_MC_BOSQUES, COLOR_AGRICULTURA, COLOR_GANADERIA_Y_PASTOS,
COLOR_ZONAS_HUMEDALES, COLOR_INFRAESTRUCTURA, COLOR_OTRAS_TIERRAS,
COLOR_NO_CLASIFICACION, COLOR_NULO,
COLOR_MC_BOSQUES, COLOR_AGRICULTURA, COLOR_GANADERIA_Y_PASTOS,
COLOR_ZONAS_HUMEDALES, COLOR_INFRAESTRUCTURA, COLOR_OTRAS_TIERRAS,
COLOR_NO_CLASIFICACION, COLOR_NULO
)
# Agregar columnas de códigos para usar en el gráfico de Sankey
puntos_sankey <- puntos_sankey |>
mutate(
t1_codigo = case_when(
t1_uso == 'T1-1000-MC bosques' ~ 0,
t1_uso == 'T1-2000-Agricultura' ~ 1,
t1_uso == 'T1-3000-Ganad y past' ~ 2,
t1_uso == 'T1-4000-Zonas humed' ~ 3,
t1_uso == 'T1-5000-Infraest' ~ 4,
t1_uso == 'T1-6000-Otras tierras' ~ 5,
t1_uso == 'T1-7000 No clasif' ~ 6,
t1_uso == 'T1-Nulo' ~ 7
),
t2_codigo = case_when(
t2_uso == 'T2-1000-MC bosques' ~ 8,
t2_uso == 'T2-2000-Agricultura' ~ 9,
t2_uso == 'T2-3000-Ganad y past' ~ 10,
t2_uso == 'T2-4000-Zonas humed' ~ 11,
t2_uso == 'T2-5000-Infraest' ~ 12,
t2_uso == 'T2-6000-Otras tierras' ~ 13,
t2_uso == 'T2-7000 No clasif' ~ 14,
t2_uso == 'T2-Nulo' ~ 15
)
)
# Contar las combinaciones de t1_codigo y t2_codigo
conteo_combinaciones <-
puntos_sankey |>
count(t1_codigo, t2_codigo)
# Crear las listas separadas
source <- conteo_combinaciones$t1_codigo
target <- conteo_combinaciones$t2_codigo
value <- conteo_combinaciones$n
# Gráfico de Sankey
grafico_sankey <-
plot_ly(
type = "sankey",
orientation = "h",
node = list(
label = label,
color = color,
pad = 15,
thickness = 20,
line = list(
color = "black",
width = 0.5
),
font = list(
size = 12,
color = "#000000",
weight = "bold"
)
),
link = list(
source = source,
target = target,
value =  value,
color = "#9c9c9c"
)
)
grafico_sankey <-
grafico_sankey |>
layout(
font = list(
size = 12,
color = "#000000",
weight = "bold"
)
)
grafico_sankey
